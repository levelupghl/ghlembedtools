/*!***************************************
 * Level Up iFrame Resizer
 * https//levelupghl.com
 * Version: v1.0.1
 ****************************************/(function(d){"use strict";function y(e,t){let n;return function(){const o=()=>{clearTimeout(n),e()};clearTimeout(n),n=window.setTimeout(o,t)}}function b(e=null){let t;e?t=e.startsWith("?")?e:new URL(e).search:t=window.location.search||new URL(window.location.href).search;const n=new URLSearchParams(t),o={};return n.forEach((r,u)=>{o[u]=r}),o}function p(e){const t={};return e.forEach(n=>{for(const o in n)n.hasOwnProperty(o)&&(t[o]=n[o])}),t}function I(){try{const e="__storage_test__",t=window.localStorage;t.setItem(e,e);const n=t.getItem(e);return t.removeItem(e),e===n}catch(e){return!1}}var m,f;const L=!0,P="iframe:not([data-embed-tools-init])",w=[],T=window.location.search,_=I(),Q=["/form","/survey","/booking","/group"];let s=[];const l={debug:L,sendQueryParams:g};function g(e,t=null){h(e,t),s.push(e)}function h(e,t=null){t?v(t,e):w.forEach(n=>{v(n,e)})}function v(e,t){var n,o;const r=new URL(document.location.href),u=e.dataset.embedToolsLocationId,c=S(u),i=c?c.referrer:document.referrer,a=((n=e.dataset)==null?void 0:n.layoutIframeId)||e.id;(o=e.contentWindow)==null||o.postMessage(["query-params",t,r.toString(),i,a],"*")}function S(e){if(!_||!e)return;const t=`v3_first_session_event_${e}`;try{const n=localStorage.getItem(t);if(!n)return null;const o=JSON.parse(n);return new Date().getTime()>o.expiry?(localStorage.removeItem(t),null):o.value}catch(n){return null}}function E(e){if(!e)return;const t=Array.from(document.getElementsByTagName("iframe"));for(let n of t)if(n.contentWindow===e)return n}function O(e){l.debug&&console.log("[EMBEDTOOLS] received message:",e,e.data);const t=e.data;if(typeof t=="object"&&t[0]==="fetch-query-params"){const n=E(e.source);n&&(n.dataset.embedToolsLocationId=t[2]);const o=window.location.search.length>1?window.location.search:T;let r=b(o);s&&s.length&&(r=p([r,...s])),setTimeout(()=>{h(r,n||null)},10)}}function q(e){var t,n,o,r,u;const c=a=>{if(a.dataset.embedToolsInit)return!1;const A=a.src||a.dataset.src||"";return Q.some(M=>A.includes(M))},i=()=>{Array.from(e.querySelectorAll(P)).filter(c).forEach(a=>{a.dataset.embedToolsInit="true",w.push(a)})};window.addEventListener("message",O),i(),(o=(n=(t=window.levelup)==null?void 0:t.sendQueryParams)==null?void 0:n.queue)!=null&&o.length&&(s=(u=(r=window.levelup)==null?void 0:r.sendQueryParams)==null?void 0:u.queue),new MutationObserver(y(i,50)).observe(e.body,{attributes:!1,childList:!0,subtree:!0})}return q(window.document),window.levelup?((m=window.levelup).debug!=null||(m.debug=l.debug),(f=window.levelup).sendQueryParams!=null||(f.sendQueryParams=l.sendQueryParams)):window.levelup=l,d.sendQueryParams=g,d})({});
//# sourceMappingURL=queryParams.min.js.map
